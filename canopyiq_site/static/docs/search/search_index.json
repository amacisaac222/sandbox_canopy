{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Your Agents, Under Control","text":"<p>Enterprise AI is powerful\u2014but risky. CanopyIQ is the safety layer that makes agents safe by default with sandboxing, policy enforcement, audit logging, and human approvals\u2014scaling from 10 to 10,000+ agents.</p> <p>What you get</p> <ul> <li>Sandbox every action \u2014 contain agents at runtime</li> <li>Enforce policy \u2014 real-time allow/deny/approve in &lt;10ms</li> <li>Prove compliance \u2014 immutable audits, export to SIEM</li> <li>Scale safely \u2014 stateless, horizontally scalable</li> </ul> <pre><code>flowchart LR\n    A[Agent] --&gt; B[CanopyIQ Sandbox]\n    B --&gt; C{Policy Engine&lt;br/&gt;(&lt; 10ms)}\n    C --&gt;|Allow| D[Action Executes]\n    C --&gt;|Deny| E[Blocked + Audit]\n    C --&gt;|Approval| F[Human-in-the-Loop]\n    F --&gt;|Approve/Deny| C\n    E --&gt; G[(Immutable Audit Log)]\n    D --&gt; G</code></pre> <p>Quick links \u2192 Quick Start \u2022 Policy Spec \u2022 Security</p>"},{"location":"faq/","title":"FAQ","text":"<p>Will this slow agents down? Policies evaluate in &lt;10ms. Approvals add human latency only when needed.</p> <p>Do we need to rewrite agents? No. Use the SDK or run as a proxy layer.</p> <p>Can it run offline? Yes. Signed policy bundles allow offline enforcement.</p> <p>Where are logs stored? In your infra (Postgres/S3). You control retention and export.</p>"},{"location":"quickstart/","title":"Quick Start","text":"<p>Get CanopyIQ running in minutes.</p>"},{"location":"quickstart/#1-install","title":"1) Install","text":"<pre><code>git clone https://github.com/your-org/canopyiq.git\ncd canopyiq\npip install -r requirements.txt\n</code></pre>"},{"location":"quickstart/#2-run-a-demo-agent","title":"2) Run a demo agent","text":"<pre><code>python examples/agent_demo.py\n</code></pre> <p>Expected:</p> <ol> <li>The agent attempts an HTTP call.</li> <li>CanopyIQ intercepts with policy.</li> <li>You see ALLOW/DENY/APPROVAL decisions and an audit record.</li> </ol>"},{"location":"quickstart/#3-next-steps","title":"3) Next steps","text":"<ul> <li>Add the SDK to your agent \u2192 SDK (Python)</li> <li>Write your first rules \u2192 Policy Spec</li> <li>Send approvals to Slack \u2192 Slack Approvals</li> </ul>"},{"location":"roadmap/","title":"Roadmap","text":"<ul> <li>v0.1: Open-core, SDKs, CLI, baseline policies</li> <li>v0.2: Slack/Teams approvals, SIEM sinks, Grafana dashboards</li> <li>v0.3: SSO (OIDC), RBAC/UI, compliance packs</li> <li>v1.0: Enterprise hardening (HA, backups, SOC2 readiness)</li> </ul>"},{"location":"security-whitepaper/","title":"CanopyIQ Security Whitepaper","text":"<p>Version: 1.0 Date: January 2025 Classification: Public</p>"},{"location":"security-whitepaper/#executive-summary","title":"Executive Summary","text":"<p>CanopyIQ is a runtime sandbox and policy control plane designed to enable secure execution of AI agents at enterprise scale. This whitepaper outlines the comprehensive security architecture, threat model, and defensive mechanisms implemented to protect against AI-specific and traditional application security risks.</p> <p>As AI agents become increasingly autonomous and handle sensitive data, the need for robust security controls becomes paramount. CanopyIQ addresses these challenges through defense-in-depth strategies, comprehensive audit trails, and enterprise-grade access controls.</p>"},{"location":"security-whitepaper/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Threat Model</li> <li>Architecture Overview</li> <li>Data Flows and Security Boundaries</li> <li>Encryption and Cryptography</li> <li>Authentication and Authorization</li> <li>Audit Logging and Monitoring</li> <li>Observability and Security Monitoring</li> <li>Air-Gapped Deployment Mode</li> <li>Security Controls Matrix</li> <li>Compliance and Standards</li> <li>Incident Response</li> <li>Security Development Lifecycle</li> <li>Conclusion</li> </ol>"},{"location":"security-whitepaper/#1-introduction","title":"1. Introduction","text":""},{"location":"security-whitepaper/#11-purpose-and-scope","title":"1.1 Purpose and Scope","text":"<p>This document provides a comprehensive security analysis of CanopyIQ, covering:</p> <ul> <li>Threat modeling and risk assessment</li> <li>Security architecture and controls</li> <li>Data protection mechanisms</li> <li>Access control implementation</li> <li>Monitoring and audit capabilities</li> <li>Deployment security considerations</li> </ul>"},{"location":"security-whitepaper/#12-security-principles","title":"1.2 Security Principles","text":"<p>CanopyIQ is built on the following security principles:</p> <ol> <li>Zero Trust Architecture - Never trust, always verify</li> <li>Defense in Depth - Multiple layers of security controls</li> <li>Principle of Least Privilege - Minimal necessary access</li> <li>Security by Design - Security integrated from the ground up</li> <li>Transparency and Auditability - Comprehensive logging and monitoring</li> <li>Fail Secure - Safe defaults and graceful degradation</li> </ol>"},{"location":"security-whitepaper/#2-threat-model","title":"2. Threat Model","text":""},{"location":"security-whitepaper/#21-asset-classification","title":"2.1 Asset Classification","text":""},{"location":"security-whitepaper/#211-critical-assets","title":"2.1.1 Critical Assets","text":"<ul> <li>Agent Execution Environment - Sandboxed runtime for AI agents</li> <li>Policy Engine - Rules and controls governing agent behavior</li> <li>Audit Data - Security logs and compliance records</li> <li>Authentication Credentials - User sessions and API keys</li> <li>Agent Code and Data - Proprietary algorithms and training data</li> </ul>"},{"location":"security-whitepaper/#212-data-classification","title":"2.1.2 Data Classification","text":"<ul> <li>Public - Documentation, marketing materials</li> <li>Internal - Configuration templates, non-sensitive logs</li> <li>Confidential - Agent policies, execution metadata</li> <li>Restricted - Authentication tokens, encryption keys, PII</li> </ul>"},{"location":"security-whitepaper/#22-threat-actors","title":"2.2 Threat Actors","text":""},{"location":"security-whitepaper/#221-external-threats","title":"2.2.1 External Threats","text":"<ul> <li>Malicious Attackers - Unauthorized access attempts</li> <li>Advanced Persistent Threats (APTs) - Nation-state actors</li> <li>Insider Threats - Compromised employee accounts</li> <li>Supply Chain Attacks - Compromised dependencies</li> </ul>"},{"location":"security-whitepaper/#222-ai-specific-threats","title":"2.2.2 AI-Specific Threats","text":"<ul> <li>Prompt Injection - Malicious input to AI agents</li> <li>Model Poisoning - Corrupted training data or models</li> <li>Data Exfiltration - Unauthorized access to training data</li> <li>Agent Escape - Breaking out of sandbox environments</li> </ul>"},{"location":"security-whitepaper/#23-attack-vectors","title":"2.3 Attack Vectors","text":""},{"location":"security-whitepaper/#231-network-based-attacks","title":"2.3.1 Network-Based Attacks","text":"<ul> <li>Man-in-the-Middle - Intercepting communications</li> <li>DDoS/DoS - Service availability attacks</li> <li>Protocol Exploitation - Network protocol vulnerabilities</li> </ul>"},{"location":"security-whitepaper/#232-application-level-attacks","title":"2.3.2 Application-Level Attacks","text":"<ul> <li>Injection Attacks - SQL, NoSQL, command injection</li> <li>Cross-Site Scripting (XSS) - Client-side code injection</li> <li>Cross-Site Request Forgery (CSRF) - Unauthorized actions</li> <li>Authentication Bypass - Circumventing access controls</li> </ul>"},{"location":"security-whitepaper/#233-infrastructure-attacks","title":"2.3.3 Infrastructure Attacks","text":"<ul> <li>Container Escape - Breaking out of containerized environments</li> <li>Privilege Escalation - Gaining unauthorized elevated access</li> <li>Kubernetes Attacks - Exploiting orchestration vulnerabilities</li> <li>Cloud Misconfigurations - Insecure cloud resource settings</li> </ul>"},{"location":"security-whitepaper/#24-risk-assessment-matrix","title":"2.4 Risk Assessment Matrix","text":"Threat Likelihood Impact Risk Level Mitigation Priority Prompt Injection High High Critical P0 Authentication Bypass Medium High High P1 Data Exfiltration Medium High High P1 Container Escape Low High Medium P2 DDoS Attack High Medium Medium P2 Supply Chain Attack Low High Medium P2"},{"location":"security-whitepaper/#3-architecture-overview","title":"3. Architecture Overview","text":""},{"location":"security-whitepaper/#31-security-architecture-diagram","title":"3.1 Security Architecture Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     Security Perimeter                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                    Load Balancer (TLS)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502   Web UI    \u2502  \u2502  Admin UI   \u2502  \u2502  API Layer  \u2502          \u2502\n\u2502  \u2502   (React)   \u2502  \u2502  (FastAPI)  \u2502  \u2502  (FastAPI)  \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502    RBAC     \u2502  \u2502   Session   \u2502  \u2502   Policy    \u2502          \u2502\n\u2502  \u2502   Engine    \u2502  \u2502  Manager    \u2502  \u2502   Engine    \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502   Agent     \u2502  \u2502   Sandbox   \u2502  \u2502   Audit     \u2502          \u2502\n\u2502  \u2502  Runtime    \u2502  \u2502  Manager    \u2502  \u2502   Logger    \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502  Database   \u2502  \u2502   Secrets   \u2502  \u2502   Metrics   \u2502          \u2502\n\u2502  \u2502 (Encrypted) \u2502  \u2502  Manager    \u2502  \u2502  Collector  \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"security-whitepaper/#32-security-zones","title":"3.2 Security Zones","text":""},{"location":"security-whitepaper/#321-dmz-demilitarized-zone","title":"3.2.1 DMZ (Demilitarized Zone)","text":"<ul> <li>Load Balancer - SSL termination and traffic distribution</li> <li>Web Application Firewall - Application-layer filtering</li> <li>Rate Limiting - DoS protection and abuse prevention</li> </ul>"},{"location":"security-whitepaper/#322-application-zone","title":"3.2.2 Application Zone","text":"<ul> <li>Web Interface - User-facing application components</li> <li>API Services - RESTful interfaces for agent management</li> <li>Authentication Services - OIDC/SAML integration</li> </ul>"},{"location":"security-whitepaper/#323-processing-zone","title":"3.2.3 Processing Zone","text":"<ul> <li>Agent Runtime - Sandboxed execution environment</li> <li>Policy Engine - Rule evaluation and enforcement</li> <li>Session Management - User session handling</li> </ul>"},{"location":"security-whitepaper/#324-data-zone","title":"3.2.4 Data Zone","text":"<ul> <li>Database - Encrypted data storage</li> <li>Secrets Management - Credential and key storage</li> <li>Audit Storage - Security event logs</li> </ul>"},{"location":"security-whitepaper/#4-data-flows-and-security-boundaries","title":"4. Data Flows and Security Boundaries","text":""},{"location":"security-whitepaper/#41-data-flow-diagram","title":"4.1 Data Flow Diagram","text":"<pre><code>User Browser \u2500TLS\u2500\u2510\n                  \u251c\u2500\u2192 Load Balancer \u2500TLS\u2500\u2192 Application Services\nAdmin Panel \u2500TLS\u2500\u2518                            \u2502\n                                               \u251c\u2500mTLS\u2500\u2192 Agent Runtime\nAPI Clients \u2500mTLS\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n                                                         \u251c\u2500Encrypted\u2500\u2192 Database\nExternal Services \u2190\u2500TLS\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"security-whitepaper/#42-security-boundaries","title":"4.2 Security Boundaries","text":""},{"location":"security-whitepaper/#421-network-boundaries","title":"4.2.1 Network Boundaries","text":"<ul> <li>Internet \u2194 DMZ - Firewall rules, DDoS protection</li> <li>DMZ \u2194 Application Zone - Internal firewalls, VPC security groups</li> <li>Application \u2194 Data Zone - Database firewalls, network segmentation</li> </ul>"},{"location":"security-whitepaper/#422-process-boundaries","title":"4.2.2 Process Boundaries","text":"<ul> <li>User Space \u2194 Kernel - System call filtering, seccomp</li> <li>Container \u2194 Host - Namespace isolation, cgroups</li> <li>Application \u2194 Runtime - Sandbox isolation, resource limits</li> </ul>"},{"location":"security-whitepaper/#423-trust-boundaries","title":"4.2.3 Trust Boundaries","text":"<ul> <li>Unauthenticated \u2194 Authenticated - Authentication gates</li> <li>User \u2194 Admin - Role-based access controls</li> <li>Internal \u2194 External - API authentication, mTLS</li> </ul>"},{"location":"security-whitepaper/#43-data-classification-and-handling","title":"4.3 Data Classification and Handling","text":""},{"location":"security-whitepaper/#431-data-in-transit","title":"4.3.1 Data in Transit","text":"<ul> <li>TLS 1.3 for all external communications</li> <li>mTLS for service-to-service communication</li> <li>Perfect Forward Secrecy for session encryption</li> <li>Certificate pinning for critical connections</li> </ul>"},{"location":"security-whitepaper/#432-data-at-rest","title":"4.3.2 Data at Rest","text":"<ul> <li>AES-256-GCM for database encryption</li> <li>Key Management Service (KMS) integration</li> <li>Encrypted backups with separate key storage</li> <li>Secure key rotation procedures</li> </ul>"},{"location":"security-whitepaper/#433-data-in-processing","title":"4.3.3 Data in Processing","text":"<ul> <li>Memory encryption where supported</li> <li>Secure enclaves for sensitive operations</li> <li>Data residency controls for compliance</li> <li>Secure deletion of temporary data</li> </ul>"},{"location":"security-whitepaper/#5-encryption-and-cryptography","title":"5. Encryption and Cryptography","text":""},{"location":"security-whitepaper/#51-encryption-standards","title":"5.1 Encryption Standards","text":""},{"location":"security-whitepaper/#511-symmetric-encryption","title":"5.1.1 Symmetric Encryption","text":"<ul> <li>Algorithm: AES-256-GCM</li> <li>Key Size: 256 bits</li> <li>Mode: Galois/Counter Mode (authenticated encryption)</li> <li>IV Generation: Cryptographically secure random</li> </ul>"},{"location":"security-whitepaper/#512-asymmetric-encryption","title":"5.1.2 Asymmetric Encryption","text":"<ul> <li>Algorithm: RSA-4096 or ECDSA P-384</li> <li>Key Exchange: ECDH with P-384 curve</li> <li>Digital Signatures: RSA-PSS or ECDSA</li> <li>Hash Functions: SHA-384 or SHA-512</li> </ul>"},{"location":"security-whitepaper/#52-key-management","title":"5.2 Key Management","text":""},{"location":"security-whitepaper/#521-key-hierarchy","title":"5.2.1 Key Hierarchy","text":"<pre><code>Root Key (Hardware Security Module)\n    \u251c\u2500\u2500 Master Encryption Key (MEK)\n    \u2502   \u251c\u2500\u2500 Data Encryption Key (DEK) - Database\n    \u2502   \u251c\u2500\u2500 Key Encryption Key (KEK) - Secrets\n    \u2502   \u2514\u2500\u2500 Session Encryption Key (SEK) - API\n    \u2514\u2500\u2500 Signing Keys\n        \u251c\u2500\u2500 JWT Signing Key\n        \u251c\u2500\u2500 Audit Log Signing Key\n        \u2514\u2500\u2500 API Certificate Key\n</code></pre>"},{"location":"security-whitepaper/#522-key-lifecycle-management","title":"5.2.2 Key Lifecycle Management","text":"<ul> <li>Generation: Hardware random number generators</li> <li>Distribution: Secure key exchange protocols</li> <li>Storage: Hardware Security Modules (HSM) or KMS</li> <li>Rotation: Automated rotation every 90 days</li> <li>Revocation: Immediate revocation capability</li> <li>Destruction: Secure key deletion procedures</li> </ul>"},{"location":"security-whitepaper/#53-transport-layer-security","title":"5.3 Transport Layer Security","text":""},{"location":"security-whitepaper/#531-tls-configuration","title":"5.3.1 TLS Configuration","text":"<pre><code>TLS Version: 1.3 (minimum 1.2)\nCipher Suites:\n  - TLS_AES_256_GCM_SHA384\n  - TLS_CHACHA20_POLY1305_SHA256\n  - TLS_AES_128_GCM_SHA256\nCertificate Validation: Full chain validation\nHSTS: Enabled with 1-year max-age\nOCSP Stapling: Enabled\n</code></pre>"},{"location":"security-whitepaper/#532-certificate-management","title":"5.3.2 Certificate Management","text":"<ul> <li>Certificate Authority: Internal CA or trusted public CA</li> <li>Certificate Types: RSA-4096 or ECDSA P-384</li> <li>Validity Period: 90 days maximum</li> <li>Automated Renewal: ACME protocol integration</li> <li>Certificate Transparency: CT log monitoring</li> </ul>"},{"location":"security-whitepaper/#54-cryptographic-implementation","title":"5.4 Cryptographic Implementation","text":""},{"location":"security-whitepaper/#541-random-number-generation","title":"5.4.1 Random Number Generation","text":"<ul> <li>Entropy Sources: Hardware RNG, OS entropy pool</li> <li>PRNG: ChaCha20-based cryptographically secure PRNG</li> <li>Seeding: Regular re-seeding from entropy sources</li> <li>Testing: NIST statistical test suite validation</li> </ul>"},{"location":"security-whitepaper/#542-secure-coding-practices","title":"5.4.2 Secure Coding Practices","text":"<ul> <li>Constant-time algorithms to prevent timing attacks</li> <li>Memory protection for cryptographic material</li> <li>Secure random for all cryptographic operations</li> <li>Side-channel resistance in implementation</li> </ul>"},{"location":"security-whitepaper/#6-authentication-and-authorization","title":"6. Authentication and Authorization","text":""},{"location":"security-whitepaper/#61-authentication-mechanisms","title":"6.1 Authentication Mechanisms","text":""},{"location":"security-whitepaper/#611-multi-factor-authentication-mfa","title":"6.1.1 Multi-Factor Authentication (MFA)","text":"<ul> <li>Primary Factor: Username/password or certificate</li> <li>Secondary Factor: TOTP, WebAuthn, or SMS</li> <li>Risk-Based Authentication: Adaptive MFA based on context</li> <li>Backup Codes: Secure recovery mechanisms</li> </ul>"},{"location":"security-whitepaper/#612-single-sign-on-sso-integration","title":"6.1.2 Single Sign-On (SSO) Integration","text":"<pre><code>Supported Protocols:\n  - OIDC (OpenID Connect) 1.0\n  - SAML 2.0\n  - OAuth 2.0 with PKCE\n\nIdentity Providers:\n  - Azure Active Directory\n  - Okta\n  - Auth0\n  - Google Workspace\n  - Generic OIDC providers\n\nToken Validation:\n  - JWT signature verification\n  - Token expiration checking\n  - Issuer validation\n  - Audience validation\n</code></pre>"},{"location":"security-whitepaper/#613-api-authentication","title":"6.1.3 API Authentication","text":"<ul> <li>Bearer Tokens: JWT with short expiration</li> <li>API Keys: Long-lived keys with scoped permissions</li> <li>Client Certificates: mTLS for service-to-service</li> <li>Service Account Keys: Rotatable machine credentials</li> </ul>"},{"location":"security-whitepaper/#62-role-based-access-control-rbac","title":"6.2 Role-Based Access Control (RBAC)","text":""},{"location":"security-whitepaper/#621-role-hierarchy","title":"6.2.1 Role Hierarchy","text":"<pre><code>Super Admin\n\u251c\u2500\u2500 Admin\n\u2502   \u251c\u2500\u2500 Agent Operator\n\u2502   \u251c\u2500\u2500 Policy Manager\n\u2502   \u2514\u2500\u2500 Auditor\n\u251c\u2500\u2500 Developer\n\u2502   \u251c\u2500\u2500 Agent Developer\n\u2502   \u2514\u2500\u2500 Policy Developer\n\u2514\u2500\u2500 Viewer\n    \u251c\u2500\u2500 Agent Viewer\n    \u2514\u2500\u2500 Audit Viewer\n</code></pre>"},{"location":"security-whitepaper/#622-permission-matrix","title":"6.2.2 Permission Matrix","text":"Role Agent Execute Agent Deploy Policy Edit Audit View Admin Access Super Admin \u2713 \u2713 \u2713 \u2713 \u2713 Admin \u2713 \u2713 \u2713 \u2713 \u2713 Agent Operator \u2713 \u2713 \u2717 \u2717 \u2717 Policy Manager \u2717 \u2717 \u2713 \u2713 \u2717 Auditor \u2717 \u2717 \u2717 \u2713 \u2717 Developer \u2713 \u2717 \u2717 \u2717 \u2717 Viewer \u2717 \u2717 \u2717 \u2713 \u2717"},{"location":"security-whitepaper/#623-attribute-based-access-control-abac","title":"6.2.3 Attribute-Based Access Control (ABAC)","text":"<ul> <li>Subject Attributes: User ID, roles, groups, clearance level</li> <li>Resource Attributes: Classification, owner, project</li> <li>Environment Attributes: Time, location, network</li> <li>Action Attributes: Operation type, risk level</li> </ul>"},{"location":"security-whitepaper/#63-session-management","title":"6.3 Session Management","text":""},{"location":"security-whitepaper/#631-session-security","title":"6.3.1 Session Security","text":"<ul> <li>Session Tokens: Cryptographically secure random IDs</li> <li>Token Expiration: 8-hour default with configurable limits</li> <li>Session Invalidation: Immediate logout capability</li> <li>Concurrent Sessions: Configurable limits per user</li> <li>Session Fixation Protection: Token regeneration on privilege change</li> </ul>"},{"location":"security-whitepaper/#632-jwt-token-security","title":"6.3.2 JWT Token Security","text":"<pre><code>{\n  \"alg\": \"RS256\",\n  \"typ\": \"JWT\",\n  \"kid\": \"key-id-2025-01\"\n}\n{\n  \"iss\": \"https://canopyiq.example.com\",\n  \"sub\": \"user@example.com\",\n  \"aud\": \"canopyiq-api\",\n  \"exp\": 1735689600,\n  \"iat\": 1735603200,\n  \"jti\": \"unique-token-id\",\n  \"roles\": [\"agent-operator\"],\n  \"groups\": [\"engineering\"]\n}\n</code></pre>"},{"location":"security-whitepaper/#7-audit-logging-and-monitoring","title":"7. Audit Logging and Monitoring","text":""},{"location":"security-whitepaper/#71-audit-framework","title":"7.1 Audit Framework","text":""},{"location":"security-whitepaper/#711-audit-event-categories","title":"7.1.1 Audit Event Categories","text":"<ul> <li>Authentication Events - Login, logout, MFA challenges</li> <li>Authorization Events - Permission grants, denials</li> <li>Data Access Events - Read, write, delete operations</li> <li>Administrative Events - Configuration changes, user management</li> <li>System Events - Service start/stop, errors, alerts</li> </ul>"},{"location":"security-whitepaper/#712-audit-event-structure","title":"7.1.2 Audit Event Structure","text":"<pre><code>{\n  \"timestamp\": \"2025-01-20T10:30:00.000Z\",\n  \"event_id\": \"uuid-v4\",\n  \"event_type\": \"authentication.login.success\",\n  \"actor\": {\n    \"user_id\": \"user@example.com\",\n    \"session_id\": \"session-uuid\",\n    \"source_ip\": \"192.168.1.100\",\n    \"user_agent\": \"Mozilla/5.0...\"\n  },\n  \"target\": {\n    \"resource_type\": \"user_session\",\n    \"resource_id\": \"session-uuid\"\n  },\n  \"action\": \"login\",\n  \"result\": \"success\",\n  \"risk_score\": 2,\n  \"metadata\": {\n    \"authentication_method\": \"oidc\",\n    \"mfa_used\": true,\n    \"login_duration\": 1.234\n  }\n}\n</code></pre>"},{"location":"security-whitepaper/#713-audit-trail-integrity","title":"7.1.3 Audit Trail Integrity","text":"<ul> <li>Cryptographic Signing: HMAC-SHA256 or digital signatures</li> <li>Immutable Storage: Write-only audit logs</li> <li>Tamper Detection: Hash chains and merkle trees</li> <li>Non-Repudiation: Digital signatures with timestamps</li> </ul>"},{"location":"security-whitepaper/#72-security-event-monitoring","title":"7.2 Security Event Monitoring","text":""},{"location":"security-whitepaper/#721-real-time-alerting","title":"7.2.1 Real-Time Alerting","text":"<pre><code>High-Priority Alerts:\n  - Authentication failures (threshold: 5 in 5 minutes)\n  - Privilege escalation attempts\n  - Unauthorized API access\n  - System security policy violations\n  - Data exfiltration indicators\n\nMedium-Priority Alerts:\n  - Unusual access patterns\n  - Failed authorization attempts\n  - Policy violations\n  - Configuration changes\n  - Service availability issues\n\nLow-Priority Alerts:\n  - Informational events\n  - Successful authentications\n  - Normal operational events\n</code></pre>"},{"location":"security-whitepaper/#722-security-metrics","title":"7.2.2 Security Metrics","text":"<ul> <li>Authentication Success Rate - Percentage of successful logins</li> <li>Failed Authentication Rate - Rate of failed login attempts</li> <li>Privilege Escalation Attempts - Count of unauthorized elevation</li> <li>API Error Rates - Percentage of API call failures</li> <li>Response Time Anomalies - Unusual response time patterns</li> </ul>"},{"location":"security-whitepaper/#73-compliance-and-retention","title":"7.3 Compliance and Retention","text":""},{"location":"security-whitepaper/#731-retention-policies","title":"7.3.1 Retention Policies","text":"<ul> <li>Security Events: 7 years retention minimum</li> <li>Audit Logs: 5 years retention minimum</li> <li>Access Logs: 2 years retention minimum</li> <li>System Logs: 1 year retention minimum</li> </ul>"},{"location":"security-whitepaper/#732-compliance-standards","title":"7.3.2 Compliance Standards","text":"<ul> <li>SOC 2 Type II - Security, availability, confidentiality</li> <li>ISO 27001 - Information security management</li> <li>NIST Cybersecurity Framework - Security controls</li> <li>GDPR - Data protection and privacy</li> </ul>"},{"location":"security-whitepaper/#8-observability-and-security-monitoring","title":"8. Observability and Security Monitoring","text":""},{"location":"security-whitepaper/#81-security-monitoring-architecture","title":"8.1 Security Monitoring Architecture","text":""},{"location":"security-whitepaper/#811-data-collection","title":"8.1.1 Data Collection","text":"<pre><code>Application Logs \u2500\u2500\u2510\n                   \u251c\u2500\u2500\u2192 Log Aggregator \u2500\u2500\u2192 SIEM \u2500\u2500\u2192 Security Dashboard\nSystem Metrics \u2500\u2500\u2500\u2500\u2518                        \u2502\n                                             \u251c\u2500\u2500\u2192 Alerting System\nNetwork Flows \u2500\u2500\u2500\u2500\u2500\u2192 Flow Analyzer \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"security-whitepaper/#812-monitoring-components","title":"8.1.2 Monitoring Components","text":"<ul> <li>Log Aggregation: Centralized log collection and parsing</li> <li>Metrics Collection: Prometheus-compatible metrics</li> <li>Distributed Tracing: OpenTelemetry integration</li> <li>Security Information and Event Management (SIEM): Security event correlation</li> </ul>"},{"location":"security-whitepaper/#82-security-metrics-and-kpis","title":"8.2 Security Metrics and KPIs","text":""},{"location":"security-whitepaper/#821-security-posture-metrics","title":"8.2.1 Security Posture Metrics","text":"<pre><code>Authentication Metrics:\n  - Login success rate: &gt;99%\n  - MFA adoption rate: &gt;95%\n  - Session timeout compliance: 100%\n\nAuthorization Metrics:\n  - Access denial rate: &lt;1%\n  - Privilege escalation attempts: 0\n  - Policy violation rate: &lt;0.1%\n\nIncident Response Metrics:\n  - Mean time to detection: &lt;15 minutes\n  - Mean time to response: &lt;1 hour\n  - False positive rate: &lt;5%\n\nSystem Security Metrics:\n  - Vulnerability scan score: &gt;95%\n  - Patch compliance: &gt;98%\n  - Configuration drift: &lt;1%\n</code></pre>"},{"location":"security-whitepaper/#822-threat-detection","title":"8.2.2 Threat Detection","text":"<ul> <li>Anomaly Detection: Machine learning-based behavioral analysis</li> <li>Signature Detection: Known attack pattern matching</li> <li>Threat Intelligence: IOC and IOA correlation</li> <li>User Behavior Analytics: Deviation from normal patterns</li> </ul>"},{"location":"security-whitepaper/#83-incident-detection-and-response","title":"8.3 Incident Detection and Response","text":""},{"location":"security-whitepaper/#831-automated-response","title":"8.3.1 Automated Response","text":"<ul> <li>Account Lockout: Automatic suspension for suspicious activity</li> <li>Rate Limiting: Dynamic throttling of malicious requests</li> <li>Quarantine: Isolation of compromised components</li> <li>Evidence Collection: Automatic forensic data gathering</li> </ul>"},{"location":"security-whitepaper/#832-alert-escalation","title":"8.3.2 Alert Escalation","text":"<pre><code>Level 1: Automated Response\n    \u2193 (if unresolved in 15 minutes)\nLevel 2: Security Team Notification\n    \u2193 (if unresolved in 1 hour)\nLevel 3: Management Escalation\n    \u2193 (if critical)\nLevel 4: Executive Notification\n</code></pre>"},{"location":"security-whitepaper/#9-air-gapped-deployment-mode","title":"9. Air-Gapped Deployment Mode","text":""},{"location":"security-whitepaper/#91-air-gapped-architecture","title":"9.1 Air-Gapped Architecture","text":""},{"location":"security-whitepaper/#911-network-isolation","title":"9.1.1 Network Isolation","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Air-Gapped Environment                 \u2502\n\u2502                                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502   Admin     \u2502  \u2502   Agent     \u2502  \u2502  Database   \u2502      \u2502\n\u2502  \u2502  Workstation\u2502  \u2502  Runtime    \u2502  \u2502   Server    \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502         \u2502                \u2502                \u2502             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502           Isolated Network (VLAN)              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502   Data      \u2502  \u2190 Sneakernet/Approved Media Transfer  \u2502\n\u2502  \u2502  Transfer   \u2502                                        \u2502\n\u2502  \u2502   Station   \u2502                                        \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2191\n                 No Internet Connection\n</code></pre>"},{"location":"security-whitepaper/#912-security-considerations","title":"9.1.2 Security Considerations","text":"<ul> <li>Physical Security: Secured facilities with access controls</li> <li>Media Controls: Approved transfer media with scanning</li> <li>Personnel Security: Background checks and training</li> <li>Emanation Security: TEMPEST-compliant environments</li> </ul>"},{"location":"security-whitepaper/#92-offline-operations","title":"9.2 Offline Operations","text":""},{"location":"security-whitepaper/#921-certificate-management","title":"9.2.1 Certificate Management","text":"<ul> <li>Offline Root CA: Air-gapped certificate authority</li> <li>Certificate Distribution: Manual or approved media transfer</li> <li>CRL Distribution: Offline certificate revocation lists</li> <li>Time Synchronization: Local NTP servers or manual sync</li> </ul>"},{"location":"security-whitepaper/#922-software-updates","title":"9.2.2 Software Updates","text":"<ul> <li>Update Verification: Digital signature validation</li> <li>Staging Environment: Isolated testing before production</li> <li>Rollback Procedures: Automated fallback mechanisms</li> <li>Approval Workflows: Multi-person authorization</li> </ul>"},{"location":"security-whitepaper/#93-data-handling-in-air-gapped-mode","title":"9.3 Data Handling in Air-Gapped Mode","text":""},{"location":"security-whitepaper/#931-data-importexport","title":"9.3.1 Data Import/Export","text":"<ul> <li>Approved Media: Virus-scanned removable media</li> <li>Data Validation: Integrity checks and format validation</li> <li>Audit Trail: Complete transfer logging</li> <li>Data Sanitization: Secure deletion of temporary data</li> </ul>"},{"location":"security-whitepaper/#932-backup-and-recovery","title":"9.3.2 Backup and Recovery","text":"<ul> <li>Offline Backups: Encrypted backup media storage</li> <li>Geographic Distribution: Multiple secure locations</li> <li>Recovery Testing: Regular disaster recovery drills</li> <li>Business Continuity: Documented procedures</li> </ul>"},{"location":"security-whitepaper/#10-security-controls-matrix","title":"10. Security Controls Matrix","text":""},{"location":"security-whitepaper/#101-nist-cybersecurity-framework-mapping","title":"10.1 NIST Cybersecurity Framework Mapping","text":"Function Category Control Implementation Status Identify Asset Management ID.AM-1 Asset inventory and classification \u2713 Identify Risk Assessment ID.RA-1 Threat modeling and risk analysis \u2713 Protect Access Control PR.AC-1 Identity and credential management \u2713 Protect Data Security PR.DS-1 Data-at-rest encryption \u2713 Protect Data Security PR.DS-2 Data-in-transit encryption \u2713 Detect Continuous Monitoring DE.CM-1 Network monitoring \u2713 Detect Detection Processes DE.DP-1 Incident detection \u2713 Respond Response Planning RS.RP-1 Incident response plan \u2713 Respond Communications RS.CO-1 Stakeholder notifications \u2713 Recover Recovery Planning RC.RP-1 Business continuity plan \u2713"},{"location":"security-whitepaper/#102-security-control-implementation","title":"10.2 Security Control Implementation","text":""},{"location":"security-whitepaper/#1021-technical-controls","title":"10.2.1 Technical Controls","text":"<ul> <li>Encryption: AES-256 for data at rest, TLS 1.3 for transit</li> <li>Authentication: MFA with OIDC/SAML integration</li> <li>Authorization: RBAC with attribute-based controls</li> <li>Logging: Comprehensive audit trails with integrity protection</li> <li>Monitoring: Real-time security event monitoring</li> <li>Backup: Encrypted backups with geographic distribution</li> </ul>"},{"location":"security-whitepaper/#1022-administrative-controls","title":"10.2.2 Administrative Controls","text":"<ul> <li>Policies: Documented security policies and procedures</li> <li>Training: Security awareness and role-specific training</li> <li>Incident Response: Documented procedures and playbooks</li> <li>Change Management: Controlled change processes</li> <li>Risk Management: Regular risk assessments and mitigation</li> <li>Vendor Management: Third-party security assessments</li> </ul>"},{"location":"security-whitepaper/#1023-physical-controls","title":"10.2.3 Physical Controls","text":"<ul> <li>Facility Security: Physical access controls and monitoring</li> <li>Equipment Security: Asset management and disposal</li> <li>Environmental Controls: Power, cooling, and fire suppression</li> <li>Media Protection: Secure handling and storage</li> <li>Workspace Security: Clean desk and screen lock policies</li> </ul>"},{"location":"security-whitepaper/#11-compliance-and-standards","title":"11. Compliance and Standards","text":""},{"location":"security-whitepaper/#111-regulatory-compliance","title":"11.1 Regulatory Compliance","text":""},{"location":"security-whitepaper/#1111-data-protection-regulations","title":"11.1.1 Data Protection Regulations","text":"<ul> <li>GDPR (General Data Protection Regulation)</li> <li>Data minimization and purpose limitation</li> <li>Right to erasure and data portability</li> <li>Privacy by design and default</li> <li> <p>Data protection impact assessments</p> </li> <li> <p>CCPA (California Consumer Privacy Act)</p> </li> <li>Consumer rights and transparency</li> <li>Data sale opt-out mechanisms</li> <li>Non-discrimination provisions</li> </ul>"},{"location":"security-whitepaper/#1112-industry-standards","title":"11.1.2 Industry Standards","text":"<ul> <li>SOC 2 Type II - Service Organization Control reports</li> <li>ISO 27001 - Information Security Management System</li> <li>PCI DSS - Payment Card Industry Data Security Standard (if applicable)</li> <li>HIPAA - Health Insurance Portability and Accountability Act (if applicable)</li> </ul>"},{"location":"security-whitepaper/#1113-government-standards","title":"11.1.3 Government Standards","text":"<ul> <li>NIST Cybersecurity Framework - Risk-based security framework</li> <li>FedRAMP - Federal Risk and Authorization Management Program</li> <li>FISMA - Federal Information Security Management Act</li> <li>Common Criteria - International security evaluation standard</li> </ul>"},{"location":"security-whitepaper/#112-security-certifications","title":"11.2 Security Certifications","text":""},{"location":"security-whitepaper/#1121-external-assessments","title":"11.2.1 External Assessments","text":"<ul> <li>Third-Party Security Assessments - Annual penetration testing</li> <li>Code Security Reviews - Static and dynamic analysis</li> <li>Vulnerability Assessments - Regular security scanning</li> <li>Compliance Audits - External audit and certification</li> </ul>"},{"location":"security-whitepaper/#1122-continuous-compliance","title":"11.2.2 Continuous Compliance","text":"<ul> <li>Automated Compliance Checking - Policy-as-code implementation</li> <li>Control Testing - Regular control effectiveness testing</li> <li>Gap Analysis - Identification and remediation of gaps</li> <li>Management Reporting - Regular compliance status reports</li> </ul>"},{"location":"security-whitepaper/#12-incident-response","title":"12. Incident Response","text":""},{"location":"security-whitepaper/#121-incident-response-framework","title":"12.1 Incident Response Framework","text":""},{"location":"security-whitepaper/#1211-incident-classification","title":"12.1.1 Incident Classification","text":"<pre><code>Severity Levels:\n  Critical (P0):\n    - Data breach or unauthorized access\n    - System compromise or malware\n    - Complete service outage\n    - Safety or life-threatening issues\n\n  High (P1):\n    - Significant functionality impairment\n    - Security policy violations\n    - Partial service degradation\n    - Customer-impacting issues\n\n  Medium (P2):\n    - Minor functionality issues\n    - Performance degradation\n    - Documentation discrepancies\n    - Low-impact security events\n\n  Low (P3):\n    - Cosmetic issues\n    - Enhancement requests\n    - Informational alerts\n</code></pre>"},{"location":"security-whitepaper/#1212-response-procedures","title":"12.1.2 Response Procedures","text":"<ol> <li>Detection and Analysis</li> <li>Event identification and validation</li> <li>Impact assessment and classification</li> <li> <p>Initial containment measures</p> </li> <li> <p>Containment, Eradication, and Recovery</p> </li> <li>Isolation of affected systems</li> <li>Threat removal and system hardening</li> <li> <p>Service restoration and validation</p> </li> <li> <p>Post-Incident Activities</p> </li> <li>Lessons learned documentation</li> <li>Process improvement recommendations</li> <li>Control enhancement implementation</li> </ol>"},{"location":"security-whitepaper/#122-communication-and-escalation","title":"12.2 Communication and Escalation","text":""},{"location":"security-whitepaper/#1221-notification-matrix","title":"12.2.1 Notification Matrix","text":"Incident Severity Internal Teams Customers Regulators Media Critical \u226415 minutes \u22642 hours \u226424 hours As required High \u226430 minutes \u22644 hours \u226472 hours As required Medium \u22642 hours \u226424 hours As required N/A Low \u226424 hours As required N/A N/A"},{"location":"security-whitepaper/#1222-documentation-requirements","title":"12.2.2 Documentation Requirements","text":"<ul> <li>Incident Timeline - Detailed chronology of events</li> <li>Impact Assessment - Business and technical impact</li> <li>Response Actions - Containment and recovery steps</li> <li>Root Cause Analysis - Technical and process failures</li> <li>Improvement Plan - Preventive measures and controls</li> </ul>"},{"location":"security-whitepaper/#13-security-development-lifecycle","title":"13. Security Development Lifecycle","text":""},{"location":"security-whitepaper/#131-secure-development-practices","title":"13.1 Secure Development Practices","text":""},{"location":"security-whitepaper/#1311-development-phase-security","title":"13.1.1 Development Phase Security","text":"<ul> <li>Threat Modeling - Design-time security analysis</li> <li>Secure Coding Standards - Language-specific guidelines</li> <li>Code Reviews - Peer review with security focus</li> <li>Static Analysis - Automated code security scanning</li> <li>Dependency Scanning - Third-party component analysis</li> </ul>"},{"location":"security-whitepaper/#1312-testing-phase-security","title":"13.1.2 Testing Phase Security","text":"<ul> <li>Dynamic Testing - Runtime security testing</li> <li>Penetration Testing - Simulated attack scenarios</li> <li>Fuzzing - Input validation and error handling</li> <li>Infrastructure Testing - Configuration and deployment security</li> </ul>"},{"location":"security-whitepaper/#1313-deployment-phase-security","title":"13.1.3 Deployment Phase Security","text":"<ul> <li>Security Configuration - Hardened deployment settings</li> <li>Secret Management - Secure credential handling</li> <li>Access Controls - Least privilege implementation</li> <li>Monitoring Setup - Security event detection</li> </ul>"},{"location":"security-whitepaper/#132-supply-chain-security","title":"13.2 Supply Chain Security","text":""},{"location":"security-whitepaper/#1321-dependency-management","title":"13.2.1 Dependency Management","text":"<ul> <li>Software Bill of Materials (SBOM) - Complete dependency inventory</li> <li>Vulnerability Scanning - Regular dependency security checks</li> <li>License Compliance - Open source license validation</li> <li>Update Management - Timely security patch application</li> </ul>"},{"location":"security-whitepaper/#1322-build-security","title":"13.2.2 Build Security","text":"<ul> <li>Reproducible Builds - Deterministic build processes</li> <li>Build Environment Security - Isolated and monitored build systems</li> <li>Artifact Signing - Cryptographic signing of build outputs</li> <li>Supply Chain Verification - End-to-end integrity checking</li> </ul>"},{"location":"security-whitepaper/#14-conclusion","title":"14. Conclusion","text":""},{"location":"security-whitepaper/#141-security-posture-summary","title":"14.1 Security Posture Summary","text":"<p>CanopyIQ implements a comprehensive security architecture designed to protect against both traditional and AI-specific threats. The defense-in-depth approach ensures multiple layers of protection, while the zero-trust principles provide granular access controls and continuous verification.</p> <p>Key security strengths include:</p> <ul> <li>Robust encryption for data protection at rest and in transit</li> <li>Multi-factor authentication with enterprise SSO integration</li> <li>Comprehensive audit logging with tamper-evident trails</li> <li>Real-time monitoring with automated threat detection</li> <li>Air-gapped deployment support for high-security environments</li> </ul>"},{"location":"security-whitepaper/#142-continuous-improvement","title":"14.2 Continuous Improvement","text":"<p>Security is an ongoing process, and CanopyIQ's security posture will continue to evolve through:</p> <ul> <li>Regular security assessments and penetration testing</li> <li>Threat intelligence integration for emerging threat awareness</li> <li>Community feedback and security research collaboration</li> <li>Compliance standard updates and regulatory requirement changes</li> <li>Technology advancement adoption for enhanced security capabilities</li> </ul>"},{"location":"security-whitepaper/#143-contact-information","title":"14.3 Contact Information","text":"<p>For security-related questions, vulnerabilities, or incidents:</p> <ul> <li>Security Team: security@canopyiq.ai</li> <li>Emergency Contact: +1-555-SECURITY (24/7)</li> <li>PGP Key: Available at https://canopyiq.ai/.well-known/security.txt</li> <li>Vulnerability Disclosure: See SECURITY.md in the repository</li> </ul> <p>Document Classification: Public Last Updated: January 2025 Next Review: July 2025 Document Owner: CanopyIQ Security Team</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>Policy not applying? - Check <code>canopyiq apply-policy</code> output for parse errors. - Ensure agent SDK points to the correct policy set.</p> <p>Slack approvals not arriving? - Verify <code>SLACK_WEBHOOK_URL</code> and signing secret. - Check inbound network rules and Slack app permissions.</p> <p>High latency? - Inspect <code>/metrics</code> p95. - Ensure CPU/Memory limits are adequate and HPA is enabled.</p>"},{"location":"architecture/overview/","title":"Architecture Overview","text":"<ul> <li>Control plane: policy service, approvals service, audit log, metrics</li> <li>Data plane: per-agent sandbox + lightweight decision SDK</li> <li>Stateless: horizontal scale</li> <li>Storage: Postgres (audit), S3/Blob (exports), optional Redis (queues)</li> </ul> <pre><code>flowchart TB\n  subgraph Agent Host\n    AG[Agent]\n    SD[CanopyIQ SDK]\n  end\n  subgraph Cluster\n    CP[Policy Service]\n    AP[Approvals Service]\n    AU[(Audit DB)]\n    ME[(Metrics)]\n  end\n  AG --&gt; SD --&gt; CP --&gt;|allow/deny/approval| AG\n  CP --&gt; AU\n  AP --&gt; AU</code></pre>"},{"location":"architecture/scaling/","title":"Scaling to 10k+ Agents","text":"<ul> <li>Stateless services with HPA (K8s)</li> <li>p95 &lt; 10ms policy eval (in-memory rules + JIT filters)</li> <li>Batching and circuit-breakers for bursts</li> <li>Backpressure queues for approvals</li> </ul>"},{"location":"concepts/approvals/","title":"Human-in-the-Loop Approvals","text":"<p>Risky actions pause and notify approvers (Slack/Teams). Approver clicks Approve / Deny with a reason. Decision is logged and the agent continues or stops.</p> <p>Use cases - External email or API exfil risk - Costly cloud ops - System changes in prod</p> <p>Setup: Slack Approvals</p>"},{"location":"concepts/audit-logging/","title":"Audit Logging","text":"<p>Every decision is immutably logged with: - who/what/when (actor, agent, timestamp) - attempted action + attributes - decision (allow/deny/approval) + reason - approver identity (if applicable)</p> <p>Export to SIEM \u2192 Splunk, Sentinel, Elastic.</p>"},{"location":"concepts/compliance-templates/","title":"Compliance Templates","text":"<p>Start from a baseline and customize: - HIPAA \u2014 protect PHI; restrict destinations - GDPR \u2014 data minimization; export/delete workflows - SOX \u2014 approvals for financial-impacting actions</p> <p>Templates are YAML bundles you can version and sign.</p>"},{"location":"concepts/policy-engine/","title":"Policy Engine","text":"<p>Goal: enforce enterprise rules in &lt;10ms per decision.</p> <p>Policy actions - <code>allow</code> \u2014 execute immediately - <code>deny</code> \u2014 block and log - <code>approval</code> \u2014 pause and route to a human approver</p> <p>Match targets - Tool / API call - File operation - Network request - Command execution - Structured output schema</p> <p>See: Policy Spec</p>"},{"location":"concepts/sandbox/","title":"Sandbox","text":"<p>Each agent runs inside an isolated sandbox (container or microVM). Isolation prevents a misbehaving agent from impacting hosts or other tenants.</p> <p>Key properties - Process, FS, and network isolation - Ephemeral by default; optional persistence via volumes/snapshots - Fast spin-up for parallel tasks</p> <p>When to use persistent state - Long-running coding agents - Evaluations that must cache datasets - Iterative workflows needing replay/snapshots</p>"},{"location":"deployment/kubernetes-helm/","title":"Kubernetes (Helm)","text":"<pre><code>helm repo add canopyiq https://your-helm-repo\nhelm install canopyiq canopyiq/canopyiq \\\n  --set env.CP_DB_URL=\"postgres://...\" \\\n  --set env.SLACK_WEBHOOK_URL=\"...\"\n</code></pre> <p>Probes wired to <code>/healthz</code> and <code>/readyz</code>. Optional ServiceMonitor for Prometheus Operator.</p>"},{"location":"deployment/local-docker/","title":"Local (Docker)","text":"<pre><code>docker build -t canopyiq:dev .\ndocker run --rm -p 8080:8080 \\\n  -e CP_DB_URL=postgresql://... \\\n  -e SLACK_WEBHOOK_URL=... \\\n  canopyiq:dev\n</code></pre> <p>Health: - <code>/healthz</code> liveness - <code>/readyz</code> readiness - <code>/metrics</code> Prometheus</p>"},{"location":"deployment/terraform-aws/","title":"Terraform (AWS)","text":"<p>Module provisions: - ECS Fargate service - ALB + ACM TLS - RDS Postgres - Secrets Manager (OIDC, Slack) - CloudWatch logs</p> <p>See: <code>deploy/terraform/aws/examples/simple/main.tf</code></p>"},{"location":"legal/privacy/","title":"Privacy Policy (Draft)","text":"<p>Effective date: 2025-08-21</p> <ul> <li>Data we handle \u2014 metadata about agent actions, audit logs, basic user info for auth.</li> <li>Data we avoid \u2014 raw end-customer payloads unless explicitly configured.</li> <li>Security \u2014 TLS in transit, encryption at rest, RBAC, immutable audit.</li> <li>Retention \u2014 customer-controlled; defaults documented in deployment guides.</li> <li>Your rights \u2014 access/export/delete upon request (SaaS); full control if self-hosted.</li> <li>Contact \u2014 privacy@canopyiq.ai</li> </ul>"},{"location":"legal/terms/","title":"Terms of Use (Draft)","text":"<p>By using CanopyIQ (\"Service\"), you agree to these terms.</p> <ol> <li>License \u2014 Open-core under Apache 2.0; enterprise features require commercial terms.</li> <li>Use \u2014 You are responsible for lawful use and proper policy configuration.</li> <li>No Warranty \u2014 Provided \"as is.\"</li> <li>Liability \u2014 No indirect or consequential damages to the extent permitted by law.</li> <li>Termination \u2014 We may suspend for abuse; you may discontinue at any time.</li> <li>Governing Law \u2014 [Your jurisdiction].</li> </ol>"},{"location":"observability/logging/","title":"Logging &amp; SIEM","text":"<ul> <li>JSON structured logs with request_id</li> <li>Sinks: stdout, file, Splunk HEC, Elastic</li> <li>Export audits:   <pre><code>canopyiq export-audit --from 2025-08-01 --to 2025-08-31 --format json &gt; audit.json\n</code></pre></li> </ul>"},{"location":"observability/metrics/","title":"Metrics","text":"<p>Expose Prometheus at <code>/metrics</code>: - <code>http_requests_total{path,method,status}</code> - <code>http_request_duration_seconds_bucket{...}</code> - <code>policy_decisions_total{outcome}</code> - <code>approvals_pending</code> - <code>audit_writes_total</code></p> <p>Ship a Grafana dashboard JSON in <code>observability/grafana/</code>.</p>"},{"location":"reference/api/","title":"API Reference (REST)","text":"<p>Base URL: <code>http://localhost:8080/api</code></p> <ul> <li><code>POST /v1/check</code> \u2192 evaluate action</li> <li><code>POST /v1/approvals</code> \u2192 create pending approval</li> <li><code>POST /v1/approvals/{id}/decision</code> \u2192 approve/deny</li> <li><code>GET  /v1/audit/export?from=&amp;to=&amp;format=</code> \u2192 export logs</li> </ul> <p>Auth: bearer token (or mTLS in enterprise mode).</p>"},{"location":"reference/cli/","title":"CLI Reference","text":"<pre><code>canopyiq start [--port 8080]\ncanopyiq apply-policy FILE_OR_DIR\ncanopyiq logs [--follow]\ncanopyiq test-policy INPUT.json\ncanopyiq export-audit --from 2025-08-01 --to 2025-08-31 --format csv\n</code></pre>"},{"location":"reference/cli/#examples","title":"Examples","text":"<p>Validate a policy set: <pre><code>canopyiq test-policy samples/attempts.json\n</code></pre></p> <p>Tail decisions: <pre><code>canopyiq logs --follow\n</code></pre></p>"},{"location":"reference/policy-spec/","title":"Policy Spec","text":"<p>Policies are YAML. Each rule has: - <code>name</code>: string - <code>match</code>: action type (<code>http_request</code>, <code>file_write</code>, <code>command</code>, <code>tool_call</code>, <code>schema</code>) - <code>where</code>: optional attribute filters - <code>action</code>: <code>allow</code> | <code>deny</code> | <code>approval</code> - <code>reason</code>: optional human-readable string</p>"},{"location":"reference/policy-spec/#examples","title":"Examples","text":""},{"location":"reference/policy-spec/#1-network-egress-whitelist","title":"1) Network egress whitelist","text":"<pre><code>- name: \"Only allow internal APIs\"\n  match: \"http_request\"\n  where:\n    host_in: [\"api.internal.corp\", \"auth.internal.corp\"]\n  action: \"allow\"\n\n- name: \"Block all other egress\"\n  match: \"http_request\"\n  action: \"deny\"\n  reason: \"External egress not permitted\"\n</code></pre>"},{"location":"reference/policy-spec/#2-budget-guardrail","title":"2) Budget guardrail","text":"<pre><code>- name: \"Cap tool budget\"\n  match: \"tool_call\"\n  where:\n    tool: \"cloud.create_instance\"\n    cost_usd_over: 50\n  action: \"approval\"\n  reason: \"High-cost action\"\n</code></pre>"},{"location":"reference/policy-spec/#3-output-schema-validation","title":"3) Output schema validation","text":"<pre><code>- name: \"Enforce JSON schema\"\n  match: \"schema\"\n  where:\n    schema: \"schemas/invoice.json\"\n  action: \"deny\"\n  reason: \"Output violates schema\"\n</code></pre> <p>Evaluation order: top \u2192 bottom; first match wins (configurable).</p>"},{"location":"reference/sdk-node/","title":"SDK (Node.js / TypeScript)","text":"<pre><code>import { Guard } from \"@canopyiq/js\";\n\nconst guard = new Guard({ policies: \"policies/baseline.yaml\" });\n\nconst res = await guard.check(\"file_write\", { path: \"/etc/passwd\" });\nif (res.allow) {\n  await writeFile(\"/etc/passwd\", \"...\");\n} else if (res.approval_required) {\n  await guard.requestApproval(res);\n} else {\n  console.log(\"Blocked:\", res.reason);\n}\n</code></pre>"},{"location":"reference/sdk-python/","title":"SDK (Python)","text":"<pre><code>from canopyiq import Guard\n\nguard = Guard(policies=\"policies/baseline.yaml\")\n\n# Before performing an action:\ndecision = guard.check(\n    action=\"http_request\",\n    attrs={\"url\": \"https://api.external.com/upload\", \"bytes\": 120_000}\n)\n\nif decision.allow:\n    do_request()\nelif decision.approval_required:\n    await guard.request_approval(decision)\nelse:\n    print(\"Blocked:\", decision.reason)\n</code></pre> <ul> <li>Async + sync APIs</li> <li>Built-in schema validation helpers</li> </ul>"},{"location":"security/security-compliance/","title":"Security &amp; Compliance","text":"<ul> <li>Zero trust: sandbox every action</li> <li>Encryption: TLS in transit, KMS/TDE at rest</li> <li>RBAC: admin, auditor, viewer</li> <li>Audit: cryptographically signed, immutable</li> <li>Compliance: HIPAA/GDPR/SOX templates</li> <li>Air-gapped: local policy bundles; offline approvals (outbox)</li> </ul>"},{"location":"security/threat-model/","title":"Threat Model","text":"<p>Risks prevented - Data exfiltration via external APIs - Runaway spend (budget caps) - Unauthorized system changes - Schema-unsafe outputs</p> <p>Controls - Policy enforcement (allow/deny/approval) - Network/domain whitelists - Human approvals with identity binding - Immutable audit + SIEM export</p>"},{"location":"tutorials/hipaa-policy/","title":"Tutorial: HIPAA Baseline Policy","text":"<p>Start from a strict default and relax as needed.</p> <pre><code>- name: \"Block external PHI egress\"\n  match: \"http_request\"\n  where:\n    path_contains_any: [\"patient\", \"ssn\", \"dob\"]\n  action: \"deny\"\n\n- name: \"Approve before emailing attachments\"\n  match: \"send_email\"\n  where:\n    has_attachment: true\n  action: \"approval\"\n</code></pre> <p>Deploy: <pre><code>canopyiq apply-policy policies/hipaa.yaml\n</code></pre></p>"},{"location":"tutorials/run-100-agents/","title":"Tutorial: Run 100 Test Agents","text":"<p>Spin up 100 dummy agents to validate scale.</p>"},{"location":"tutorials/run-100-agents/#prereqs","title":"Prereqs","text":"<ul> <li>Docker or Kubernetes</li> <li>CanopyIQ runtime running</li> </ul>"},{"location":"tutorials/run-100-agents/#steps","title":"Steps","text":"<ol> <li> <p>Launch runtime: <pre><code>canopyiq start\n</code></pre></p> </li> <li> <p>Apply policies: <pre><code>canopyiq apply-policy policies/baseline.yaml\n</code></pre></p> </li> <li> <p>Launch generator: <pre><code>python scripts/agent_stress.py --agents 100 --rate 20/s\n</code></pre></p> </li> <li> <p>Observe:</p> </li> <li><code>/metrics</code> p95 latency</li> <li>Audit volumes and decisions</li> </ol>"},{"location":"tutorials/siem-splunk/","title":"Tutorial: Forward Logs to Splunk","text":"<ol> <li>Configure HEC token &amp; URL in <code>CANOPYIQ_SPLUNK_HEC_*</code>.</li> <li>Enable Splunk sink in <code>config.yaml</code>.</li> <li>Verify events:</li> <li>index: <code>canopyiq</code></li> <li>sourcetype: <code>canopyiq:audit</code></li> </ol>"},{"location":"tutorials/slack-approvals/","title":"Tutorial: Slack Approvals","text":"<p>Route approvals to Slack using an incoming webhook and interactive actions.</p>"},{"location":"tutorials/slack-approvals/#configure","title":"Configure","text":"<ul> <li><code>SLACK_WEBHOOK_URL</code></li> <li><code>SLACK_SIGNING_SECRET</code></li> </ul>"},{"location":"tutorials/slack-approvals/#test","title":"Test","text":"<pre><code>curl -X POST http://localhost:8080/api/approvals/test\n</code></pre> <p>You should see a Slack message with Approve / Deny buttons. Click \u2192 decision updates + audit record created.</p>"}]}