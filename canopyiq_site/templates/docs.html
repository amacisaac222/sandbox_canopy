{% extends "base.html" %}
{% block content %}
<section class="max-w-5xl mx-auto px-4 py-14">
  <h1 class="text-3xl font-semibold mb-8 text-primary">Documentation</h1>
  
  <!-- MCP Quick Start Section -->
  <div class="mb-12">
    <h2 class="text-2xl font-semibold mb-6 text-primary">üöÄ Claude Desktop MCP Server Quick Start</h2>
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border-2 border-blue-200 p-8">
      <div class="mb-6">
        <h3 class="text-xl font-bold mb-3 text-navy-900">Secure Claude Desktop in 30 seconds</h3>
        <p class="text-navy-700 leading-relaxed">
          The CanopyIQ MCP (Model Control Protocol) server adds security, logging, and approval workflows to your Claude Desktop tools without changing any code.
        </p>
      </div>
      
      <div class="grid lg:grid-cols-2 gap-8">
        <div class="space-y-6">
          <div class="flex items-start gap-3">
            <div class="bg-blue-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm flex-shrink-0 mt-1">1</div>
            <div>
              <h4 class="font-bold text-navy-900 mb-2">Install the MCP Server</h4>
              <div class="bg-navy-900 rounded-md p-3 font-mono text-sm text-green-400 overflow-x-auto">
                npm install -g canopyiq-mcp-server
              </div>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <div class="bg-blue-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm flex-shrink-0 mt-1">2</div>
            <div>
              <h4 class="font-bold text-navy-900 mb-2">Get Your API Key</h4>
              <p class="text-navy-700 text-sm mb-2">Sign up at CanopyIQ to get your API key:</p>
              <a href="/contact" class="inline-flex items-center gap-1 bg-coral-500 text-white px-4 py-2 rounded-md hover:bg-coral-600 transition text-sm font-medium">
                üîë Get API Key
              </a>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <div class="bg-blue-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm flex-shrink-0 mt-1">3</div>
            <div>
              <h4 class="font-bold text-navy-900 mb-2">Add to Claude Desktop</h4>
              <p class="text-navy-700 text-sm mb-2">Edit your <code class="bg-navy-100 px-1 rounded text-xs">claude_desktop_config.json</code>:</p>
              <div class="bg-navy-900 rounded-md p-3 font-mono text-xs text-green-400 overflow-x-auto">
{
  "mcpServers": {
    "canopyiq": {
      "command": "canopyiq-mcp-server",
      "args": ["--api-key", "ciq_your_key_here"]
    }
  }
}
              </div>
              <p class="text-xs text-navy-600 mt-2">üí° Config location: <code>~/Library/Application Support/Claude/claude_desktop_config.json</code> (macOS)</p>
            </div>
          </div>
        </div>
        
        <div class="bg-white rounded-lg p-6 border border-blue-200">
          <h4 class="font-bold text-navy-900 mb-4 flex items-center gap-2">
            ‚ú® What You Get
          </h4>
          <div class="space-y-3 text-sm text-navy-700">
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 bg-green-500 rounded-full flex-shrink-0"></div>
              <span><strong>Complete audit trail</strong> of all tool usage</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"></div>
              <span><strong>Human approval workflows</strong> for risky actions</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 bg-purple-500 rounded-full flex-shrink-0"></div>
              <span><strong>Rate limiting</strong> and usage quotas</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 bg-orange-500 rounded-full flex-shrink-0"></div>
              <span><strong>Policy violations</strong> sent to Slack/email</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 bg-red-500 rounded-full flex-shrink-0"></div>
              <span><strong>Emergency kill switch</strong> for runaway agents</span>
            </div>
          </div>
          
          <div class="mt-6 pt-4 border-t border-navy-200">
            <h5 class="font-semibold text-navy-900 mb-2">üéØ Perfect for:</h5>
            <div class="text-xs text-navy-600 space-y-1">
              <div>‚Ä¢ Developers using Claude Code</div>
              <div>‚Ä¢ Teams with custom MCP tools</div>
              <div>‚Ä¢ Companies needing compliance logs</div>
              <div>‚Ä¢ Anyone wanting agent oversight</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <div class="flex items-start gap-3">
          <div class="text-yellow-600 text-lg">‚ö°</div>
          <div>
            <h4 class="font-semibold text-yellow-800 mb-1">Zero Code Changes Required</h4>
            <p class="text-yellow-700 text-sm">
              The MCP server acts as a transparent proxy. Your existing Claude Desktop setup keeps working exactly the same, 
              just with added security and logging. No need to modify any tools or workflows.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Reference Architecture Section -->
  <div class="mb-12">
    <h2 class="text-2xl font-semibold mb-6 text-primary">Reference Architecture</h2>
    <div class="bg-white rounded-lg border border-slate-200 p-6">
      <figure class="mb-4">
        <div class="w-full overflow-x-auto">
          <img src="/static/architecture.svg?v={{ asset_ver }}" 
               alt="CanopyIQ Runtime Architecture Diagram" 
               class="w-full h-auto max-w-none min-w-[800px] md:min-w-0"
               style="max-height: 600px; object-fit: contain;">
        </div>
        <figcaption class="mt-4 text-center text-sm text-muted">
          <strong>Figure 1:</strong> CanopyIQ runtime architecture showing agent fleet integration, 
          local policy evaluation, human-in-the-loop approvals, and enterprise control plane services.
          The system supports 10,000+ agents with sub-10ms decision times through signed local policy bundles.
        </figcaption>
      </figure>
      
      <div class="mt-6 grid md:grid-cols-2 gap-6 text-sm">
        <div>
          <h4 class="font-semibold text-primary mb-2">Key Components</h4>
          <ul class="space-y-1 text-muted">
            <li>‚Ä¢ <strong>Sidecar/SDK:</strong> Local policy evaluation and budget enforcement</li>
            <li>‚Ä¢ <strong>Control Plane:</strong> Centralized policy management and approvals</li>
            <li>‚Ä¢ <strong>Data Layer:</strong> PostgreSQL cluster with read replicas</li>
            <li>‚Ä¢ <strong>SIEM Integration:</strong> Export to Splunk, Datadog, ELK, CloudWatch</li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold text-primary mb-2">Enterprise Features</h4>
          <ul class="space-y-1 text-muted">
            <li>‚Ä¢ <strong>Air-Gapped Deployment:</strong> Works offline with cached policies</li>
            <li>‚Ä¢ <strong>Multi-Cloud Ready:</strong> AWS, Azure, GCP, on-premises</li>
            <li>‚Ä¢ <strong>High Availability:</strong> Zero downtime deployments</li>
            <li>‚Ä¢ <strong>Compliance:</strong> SOC2, HIPAA, PCI-DSS ready</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Security Whitepaper Section -->
  <div class="mb-12">
    <h2 class="text-2xl font-semibold mb-6 text-primary">Security Whitepaper</h2>
    <div class="bg-white rounded-lg border border-slate-200 p-6">
      <p class="text-muted mb-4">
        Comprehensive security analysis covering threat modeling, data flows, encryption, 
        RBAC/SSO, audit logging, observability, and air-gapped deployment scenarios.
      </p>
      <div class="flex flex-wrap gap-4">
        <a href="/static/docs/security-whitepaper.md" 
           class="inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors">
          üìÑ View Markdown
        </a>
        <a href="/static/security-whitepaper.pdf" 
           class="inline-flex items-center px-4 py-2 bg-accent text-white rounded-md hover:bg-accent/90 transition-colors">
          üìë Download PDF
        </a>
      </div>
    </div>
  </div>

  <!-- Deployment Guides Section -->
  <div class="mb-12">
    <h2 class="text-2xl font-semibold mb-6 text-primary">Deployment Guides</h2>
    <div class="grid md:grid-cols-2 gap-6">
      <!-- Helm Chart -->
      <div class="bg-white rounded-lg border border-slate-200 p-6">
        <h3 class="text-xl font-semibold mb-3 text-primary">Kubernetes (Helm)</h3>
        <p class="text-muted mb-4">
          Production-ready Helm chart with autoscaling, health checks, monitoring, 
          and security best practices for Kubernetes deployment.
        </p>
        <div class="space-y-2 mb-4">
          <div class="text-sm">
            <span class="font-medium">Features:</span>
            <span class="text-muted">ServiceMonitor, NetworkPolicy, PodDisruptionBudget</span>
          </div>
          <div class="text-sm">
            <span class="font-medium">Security:</span>
            <span class="text-muted">Non-root containers, read-only filesystem</span>
          </div>
        </div>
        <div class="flex flex-wrap gap-2">
          <a href="https://github.com/canopyiq/canopy/tree/main/helm/canopyiq" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üìÅ Chart Directory
          </a>
          <a href="https://github.com/canopyiq/canopy/blob/main/helm/canopyiq/README.md" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üìñ README
          </a>
          <a href="https://github.com/canopyiq/canopy/blob/main/helm/canopyiq/INSTALL.md" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üöÄ Quick Install
          </a>
        </div>
      </div>

      <!-- Terraform AWS -->
      <div class="bg-white rounded-lg border border-slate-200 p-6">
        <h3 class="text-xl font-semibold mb-3 text-primary">AWS (Terraform)</h3>
        <p class="text-muted mb-4">
          Complete AWS infrastructure module using ECS Fargate, ALB, RDS PostgreSQL, 
          and AWS Secrets Manager for production deployments.
        </p>
        <div class="space-y-2 mb-4">
          <div class="text-sm">
            <span class="font-medium">Services:</span>
            <span class="text-muted">ECS Fargate, ALB, RDS, Secrets Manager</span>
          </div>
          <div class="text-sm">
            <span class="font-medium">Security:</span>
            <span class="text-muted">VPC, Security Groups, IAM roles, ACM certificates</span>
          </div>
        </div>
        <div class="flex flex-wrap gap-2">
          <a href="https://github.com/canopyiq/canopy/tree/main/deploy/terraform/aws" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üìÅ Module Directory
          </a>
          <a href="https://github.com/canopyiq/canopy/blob/main/deploy/terraform/aws/README.md" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üìñ Documentation
          </a>
          <a href="https://github.com/canopyiq/canopy/tree/main/deploy/terraform/aws/examples" 
             class="inline-flex items-center px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition-colors">
            üí° Examples
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Documentation Sections -->
  <div class="prose prose-slate max-w-none">
    <h2>Quickstart</h2>
  <pre><code># SDK init (pseudo)
client = SandboxClient(...)
client.tool_call("email.send", {...})
</code></pre>
  <h2>Policies</h2>
  <pre><code>tools:
  allow: ["crm.*"]
  deny:  ["payments.*"]
  approvals:
    - tool: "email.send"
      require: "human"
</code></pre>
  <h2>API</h2>
  <ul>
    <li>GET /v1/policies/{agent}</li>
    <li>POST /v1/approvals</li>
    <li>GET /v1/audit/export</li>
  </ul>
  </div>
</section>
{% endblock %}